(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{739:function(s,e,a){"use strict";a.r(e);var t=a(5),r=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"docker安装redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker安装redis"}},[s._v("#")]),s._v(" docker安装redis")]),s._v(" "),a("p",[s._v("[toc]")]),s._v(" "),a("h3",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("root@ubuntu:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -P redis")]),s._v("\ncdf1868c4e5eb285c152d06637aec9a02e5ffdefe0772e615546c93655e52aff\nroot@ubuntu:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID   IMAGE                   COMMAND                  CREATED             STATUS                         PORTS                                                  NAMES\ncdf1868c4e5e   redis                   "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker-entrypoint.s…"')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" seconds ago      Up "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" seconds                  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:49157-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("/tcp, :::49157-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("/tcp            wonderful_noyce\n1ff6de0064bd   mysql:5.7               "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker-entrypoint.s…"')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" minutes ago       Up "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" minutes                   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:3306-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("/tcp, :::3306-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("/tcp, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33060")]),s._v("/tcp   mysql_beifen\n22e49c33a330   billygoo/tomcat8-jdk8   "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"catalina.sh run"')]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(" minutes ago      Up "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(" minutes                  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8080-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("/tcp, :::8080-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("/tcp              tomcat03\n9e194dbf7eca   tomcat                  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"catalina.sh run"')]),s._v("        About an hour ago   Up About an hour               "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:49153-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("/tcp, :::49153-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("/tcp            tomcat02\nc6b2169449f4   ubuntu                  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bash"')]),s._v("                   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" hours ago         Up "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" hours                                                                            ubuntu2\n37d9f24e95a3   ubuntu                  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bash"')]),s._v("                   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" hours ago         Up "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" hours                                                                            u1\nf19e7fbc3d18   v2fly/v2fly-core        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/v2ray -con…"')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" hours ago         Restarting "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" seconds ago                                                          tcp\nroot@ubuntu:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it cdf1868c4e5e /bin/bash ")]),s._v("\nroot@cdf1868c4e5e:/data"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis-cli ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" k1 v1\nOK\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" get k1\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"v1"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h3",{attrs:{id:"同样的redis需要容器卷进行同步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#同样的redis需要容器卷进行同步"}},[s._v("#")]),s._v(" 同样的redis需要容器卷进行同步")]),s._v(" "),a("h5",{attrs:{id:"指定配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#指定配置文件"}},[s._v("#")]),s._v(" 指定配置文件")]),s._v(" "),a("p",[a("strong",[s._v("1. 在宿主机上面先新建目录redis")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mkdir -p /redis/redis\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("2. 将一个redis.conf文件模板拷贝到/app/redis目录下")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("apt-get install redis\nrz\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("strong",[s._v("查看我的redis配置文件路径")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("root@ubuntu:/etc/redis# ls\nredis.conf\nroot@ubuntu:/etc/redis# pwd\n/etc/redis\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("strong",[s._v("操作")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mkdir -p /redis/redis\ncp /etc/redis/redis.conf /redis/redis/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h5",{attrs:{id:"修改配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改配置文件"}},[s._v("#")]),s._v(" 修改配置文件")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("开启redis验证(服务器强烈建议)")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("requirepass 123\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("允许redis外地链接（必须）")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# bind 127.0.0.1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("将"),a("code",[s._v("daemonize yes")]),s._v("改为"),a("code",[s._v("no")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("protected-mode no\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("开启redis数据持久化"),a("code",[s._v("appendonly yes")]),s._v("可选")])])]),s._v(" "),a("h3",{attrs:{id:"创建redis实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建redis实例"}},[s._v("#")]),s._v(" 创建redis实例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker run -p 6379:6379 --name myredi01\n--priviledged=true \n-v /redis/redis/redis.conf:/etc/redis/redis.conf \n-v /redis/redis/data:/data \n-d redis\nredis-server /etc/redis/redis.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("blockquote",[a("p",[s._v("docker run -p 6379:6379 --name myredi01 --priviledged=true  -v /redis/redis/redis.conf:/etc/redis/redis.conf  -v /redis/redis/data:/data  -d redis redis-server /etc/redis/redis.conf")])]),s._v(" "),a("p",[s._v("**以前是"),a("code",[s._v("/bin/bash")]),s._v("**现在是"),a("code",[s._v("redis-server")])])])}),[],!1,null,null,null);e.default=r.exports}}]);